"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[73094],{27895:function(t,e,n){n.d(e,{Z:function(){return bt}});var r=n(77378),o=n(35155),i=n(15607),a=n(47201),c=n(51705),u=n(65443),l=n.n(u),s=n(34885),d=n(81357),m=n(30621),p=n(37327),f=n(79547),h=function(t,e,n){return{type:f.pc,payload:{commentableType:t,commentableId:e,comments:n}}},g=function(t,e,n){return{type:f.tV,payload:{commentableType:t,commentableId:e,comment:n}}},v=function(t,e,n){return{type:f.jO,payload:{commentableType:t,commentableId:e,commentId:n}}},b=n(34214),Z=function(t,e,n){return"notebookPost"===t?(0,m.Rq)(e,n):"list"===t?(0,p.$B)(e,n):"ratings"===t?(0,b.NN)(e,n):null},w=function(t,e){var n=(0,i.v9)((function(n){return{cachedComments:n.comments[t][e],httpContext:n.appState.httpContext}}),i.wU),r=n.cachedComments,o=n.httpContext,a=(0,s.useState)(!1),u=a[0],m=a[1],p=(0,i.I0)(),f=function(){var n=(0,c.Z)(l().mark((function n(){var r,i,a;return l().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,Z(t,o,e);case 3:r=n.sent,i=r.data,a="notebookPost"===t?i.comments:i,p(h(t,e,a)),n.next=13;break;case 9:n.prev=9,n.t0=n.catch(0),d.Tb(n.t0),m(!0);case 13:case"end":return n.stop()}}),n,null,[[0,9]])})));return function(){return n.apply(this,arguments)}}();return(0,s.useEffect)((function(){f()}),[]),[r,!r&&!u,u]},x=n(16389),y=n(67958),k=function(t,e){return(0,y.ZP)(t).deleteRequest("/comments/".concat(e))},C=n(55369),P=n(83134),q=n(23532),_=n(71021),A=n(88334),z=n(38118),B=n(28761),T=n(43480);var I=function(t){var e=t.comment,n=t.commentableType,r=t.commentableId,o=t.allowDeletion,u=(0,a.Z)("comments").t,s=(0,i.v9)((function(t){return{httpContext:t.appState.httpContext,isAdmin:t.user.isAdmin,currentUser:t.user.user}}),i.wU),d=s.httpContext,m=s.currentUser,p=s.isAdmin,f=(0,i.I0)(),h=e.id,g=e.user,b=e.created_at,Z=e.body,w=function(t,e){if(e){var n=(0,x.default)(e);return(0,P.k0)(n)?(0,C.$_)(t,n,{allowJustNow:!0}):(0,C.p6)(n,"dd MMM yyyy")}return""}(u,b),y=function(){var t=(0,c.Z)(l().mark((function t(){return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!confirm(u("comments:comments.confirm_delete"))){t.next=10;break}return t.prev=1,t.next=4,k(d,e.id);case 4:f(v(n,r,e.id)),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(1),console.log(t.t0);case 10:case"end":return t.stop()}}),t,null,[[1,7]])})));return function(){return t.apply(this,arguments)}}(),q=o||p||m&&m.id===(null===g||void 0===g?void 0:g.id),I=m&&m.id!==(null===g||void 0===g?void 0:g.id),O=(null===g||void 0===g?void 0:g.name)||u("comments:comments.deleted"),F=(null===g||void 0===g?void 0:g.avatar_url)||"/static/images/avatar.png";return(0,T.BX)(R,{children:[(0,T.BX)(S,{children:[(0,T.tZ)(V,{src:"".concat(F,"?size=80x80")}),(null===g||void 0===g?void 0:g.show_badge)&&(0,T.tZ)(L,{children:(0,T.tZ)(_.DE,{width:"18px"})})]}),(0,T.BX)(E,{children:[(0,T.BX)(W,{children:[null!==g&&void 0!==g&&g.canonical_url?(0,T.tZ)(z.Z,{href:g.canonical_url,children:(0,T.tZ)(j,{children:O})}):(0,T.tZ)(j,{as:"div",children:O}),(0,T.BX)(X,{children:[(0,T.tZ)(U,{children:w}),q&&(0,T.tZ)(M,{children:(0,T.tZ)(G,{onClick:y,children:(0,T.tZ)(A.Tw,{width:"10px",color:null})})}),I&&(0,T.tZ)(D,{children:(0,T.tZ)(B.Z,{tooltipId:"report-comment-".concat(h)})})]})]}),(0,T.tZ)(N,{children:Z})]})]})};I.defaultProps={allowDeletion:!1};var M=(0,o.Z)("div",{target:"e4rw94l12"})({name:"mr7dre",styles:"display:none;margin-left:10px"}),D=(0,o.Z)("div",{target:"e4rw94l11"})({name:"mr7dre",styles:"display:none;margin-left:10px"}),R=(0,o.Z)("article",{target:"e4rw94l10"})("width:100%;padding:20px;border-bottom:1px solid ",(function(t){return t.theme.color.midBackground}),";display:flex;:hover{",M,"{display:block;}",D,"{display:block;}}"),S=(0,o.Z)("div",{target:"e4rw94l9"})({name:"i2bpm4",styles:"position:relative;margin-right:20px"}),V=(0,o.Z)("img",{target:"e4rw94l8"})({name:"1v0b96u",styles:"display:block;width:40px;height:40px;object-fit:cover"}),L=(0,o.Z)("div",{target:"e4rw94l7"})({name:"yw96tr",styles:"position:absolute;top:4px;right:-10px"}),E=(0,o.Z)("div",{target:"e4rw94l6"})({name:"1ff36h2",styles:"flex-grow:1"}),W=(0,o.Z)("div",{target:"e4rw94l5"})({name:"1eoy87d",styles:"display:flex;justify-content:space-between"}),X=(0,o.Z)("div",{target:"e4rw94l4"})({name:"xmccfy",styles:"display:flex;align-items:center;height:20px"}),j=(0,o.Z)("a",{target:"e4rw94l3"})("font-weight:bold;margin-right:10px;&,&:hover{color:",(function(t){return t.theme.color.darkText}),";}"),U=(0,o.Z)("time",{target:"e4rw94l2"})("color:",(function(t){return t.theme.color.midGray}),";font-size:12px;"),N=(0,o.Z)("div",{target:"e4rw94l1"})("line-height:1.5;padding-top:6px;color:",(function(t){return t.theme.color.darkText}),";min-width:0;word-wrap:break-word;overflow-wrap:break-word;"),G=(0,o.Z)(q.Z,{target:"e4rw94l0"})("padding:5px;svg{stroke:",(function(t){return t.theme.color.midGray}),";}:hover svg{stroke:",(function(t){return t.theme.color.black}),";}"),O=I,F=n(70878),H=n(34050);var K=function(t,e,n,r){return"notebookPost"===e?function(t,e,n){return new Promise((function(r,o){if("undefined"!==typeof grecaptcha)try{grecaptcha.enterprise.ready((0,c.Z)(l().mark((function o(){var i,a;return l().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,grecaptcha.enterprise.execute("6Leny7AUAAAAABnijVtQaHmmFIgfhCGwUWV2FEWN",{action:"comment"});case 2:return i=o.sent,o.next=5,(0,y.ZP)(t).post("/notebook/posts/".concat(e,"/comments"),{data:{body:n,recaptcha_token:i,recaptcha_action:"comment"}});case 5:a=o.sent,r(a);case 7:case"end":return o.stop()}}),o)}))))}catch(i){o(i)}else o(new Error("grecaptcha not initialised"))}))}(t,n,r):"list"===e?(0,p.Ve)(t,n,r):"ratings"===e?(0,b.rG)(t,n,r):null},Q=function(t){var e=t.commentableType,n=t.commentableId,r=t.submitCopy,o=(0,a.Z)("comments").t,u=(0,i.v9)((function(t){return{user:t.user.user,activeSubscriber:t.user.activeSubscriber,httpContext:t.appState.httpContext}}),i.wU),d=u.httpContext,m=u.user,p=u.activeSubscriber,f=(0,s.useState)(!1),h=f[0],v=f[1],b=(0,s.useState)(""),Z=b[0],w=b[1],x=(0,s.useState)(""),y=x[0],k=x[1],C=(0,i.I0)(),P=function(){var t=(0,c.Z)(l().mark((function t(){var r,i,a,c,u,s,m,p;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return v(!0),t.prev=1,t.next=4,K(d,e,n,Z);case 4:r=t.sent,i=r.data,C(g(e,n,i)),w(""),t.next=14;break;case 10:t.prev=10,t.t0=t.catch(1),8===(null!==(a=null===t.t0||void 0===t.t0||null===(c=t.t0.response)||void 0===c?void 0:c.status)&&void 0!==a&&a)?C((0,F.zO)()):(p=null!==(u=null===t.t0||void 0===t.t0||null===(s=t.t0.response)||void 0===s||null===(m=s.data)||void 0===m?void 0:m.user_message)&&void 0!==u?u:o("comments:comments.errors.generic"),k(p));case 14:return t.prev=14,v(!1),t.finish(14);case 17:case"end":return t.stop()}}),t,null,[[1,10,14,17]])})));return function(){return t.apply(this,arguments)}}(),q=m.avatar_url?"".concat(m.avatar_url,"?size=80x"):"/static/images/avatar.png";return(0,T.BX)($,{children:[(0,T.BX)(J,{children:[(0,T.tZ)(Y,{src:q}),p&&(0,T.tZ)(tt,{children:(0,T.tZ)(_.DE,{width:"18px"})})]}),(0,T.tZ)(et,{onSubmit:function(t){t.preventDefault(),Z.trim().length>0?(k(""),P()):k(o("comments:comments.errors.empty_comment"))},children:(0,T.BX)("fieldset",{disabled:h,children:[(0,T.tZ)(nt,{children:m.name}),(0,T.tZ)(rt,{placeholder:o("comments:comments.comment_placeholder"),value:Z,onChange:function(t){return w(t.target.value)}}),y&&(0,T.tZ)(ot,{children:y}),(0,T.tZ)(it,{children:(0,T.tZ)(at,{type:"submit",disabled:!Z,children:r||o("comments:comments.submit")})})]})})]})};Q.defaultProps={submitCopy:null};var $=(0,o.Z)("section",{target:"eab276u9"})({name:"j7knqk",styles:"display:flex;padding:20px;width:100%"}),J=(0,o.Z)("div",{target:"eab276u8"})({name:"i2bpm4",styles:"position:relative;margin-right:20px"}),Y=(0,o.Z)("img",{target:"eab276u7"})({name:"144esrr",styles:"height:40px;width:40px"}),tt=(0,o.Z)("div",{target:"eab276u6"})({name:"yw96tr",styles:"position:absolute;top:4px;right:-10px"}),et=(0,o.Z)("form",{target:"eab276u5"})({name:"1ff36h2",styles:"flex-grow:1"}),nt=(0,o.Z)("div",{target:"eab276u4"})({name:"1dlhe70",styles:"font-size:14px;font-weight:bold"}),rt=(0,o.Z)("textarea",{target:"eab276u3"})("height:100px;margin:11px 0;width:100%;padding:7px 10px 9px;border:1px solid ",(function(t){return t.theme.color.lightGray}),";outline:none;resize:none;"),ot=(0,o.Z)("div",{target:"eab276u2"})("color:",(function(t){return t.theme.color.alertRed}),";font-size:14px;margin-bottom:8px;"),it=(0,o.Z)("div",{target:"eab276u1"})({name:"2qga7i",styles:"text-align:right"}),at=(0,o.Z)(H.Z,{target:"eab276u0"})({name:"1ejkzn",styles:"padding:6px 14px;font-size:12px"}),ct=Q,ut=n(20186),lt=n(32755),st=(0,o.Z)("div",{target:"ev7kf0s2"})("padding:20px;font-size:11px;color:",(function(t){return t.theme.color.darkText}),";@media (min-width: ",(function(t){return t.theme.mq.tablet}),"){font-size:14px;}"),dt=(0,o.Z)("div",{target:"ev7kf0s1"})("float:right;width:16px;@media (min-width: ",(function(t){return t.theme.mq.tablet}),"){width:22px;}"),mt=(0,o.Z)("span",{target:"ev7kf0s0"})("color:",(function(t){return t.theme.color.mubiBlue}),";cursor:pointer;:hover{text-decoration:underline;}"),pt=function(){var t=(0,a.Z)("comments").t,e=(0,T.tZ)(lt.Z,{children:function(e){var n=e.showModal;return(0,T.tZ)(mt,{onClick:function(){return n({flow:"signup"})},children:t("comments:comments.signup")})}});return(0,T.BX)(st,{children:[(0,T.tZ)(ut.Z,{t:t,i18nKey:"comments:comments.signup_to_comment",i18nVars:{signup_link:e}}),(0,T.tZ)(dt,{children:(0,T.tZ)(A.jF,{width:"100%"})})]})},ft=function(t){var e=t.commentableType,n=t.commentableId,o=t.submitCopy,c=t.allowDeletion,u=(0,a.Z)("comments").t,l=(0,i.v9)((function(t){return t.user.isAuthenticated})),s=w(e,n),d=(0,r.Z)(s,3),m=d[0],p=d[1];if(d[2])return null;var f=m&&0===m.length,h=m&&m.length>0;return(0,T.BX)(ht,{children:[p&&(0,T.tZ)(gt,{children:(0,T.tZ)(A.Ho,{width:"40px"})}),f&&(0,T.tZ)(vt,{children:u("comments:comments.empty")}),h&&m.map((function(t){return(0,T.tZ)(O,{comment:t,commentableType:e,commentableId:n,allowDeletion:c},t.id)})),l?(0,T.tZ)(ct,{commentableType:e,commentableId:n,submitCopy:o}):(0,T.tZ)(pt,{})]})};ft.defaultProps={submitCopy:null,allowDeletion:!1};var ht=(0,o.Z)("div",{target:"e2pyczd2"})("background-color:",(function(t){return t.theme.color.white}),";"),gt=(0,o.Z)("div",{target:"e2pyczd1"})("padding:20px;display:flex;align-items:center;justify-content:center;border-bottom:1px solid ",(function(t){return t.theme.color.midBackground}),";"),vt=(0,o.Z)("div",{target:"e2pyczd0"})("padding:20px;border-bottom:1px solid ",(function(t){return t.theme.color.midBackground}),";color:",(function(t){return t.theme.color.lightText}),";"),bt=ft},83105:function(t,e,n){var r=n(34856),o=n(86457),i=n(37920),a=n(15905),c=n(86791),u=n(6486),l=n(12197),s=n(34885),d=n(15348);function m(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=(0,u.Z)(t);if(e){var o=(0,u.Z)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return(0,c.Z)(this,n)}}var p=function(t){(0,a.Z)(n,t);var e=m(n);function n(t){var o;(0,r.Z)(this,n),o=e.call(this,t),(0,l.Z)((0,i.Z)(o),"onResize",(function(){var t=(0,d.eO)(o.props);o.setState({currentValue:t})}));var a=o.props.defaultValue;return o.state={currentValue:a},o}return(0,o.Z)(n,[{key:"componentDidMount",value:function(){this.onResize(),window.addEventListener("resize",this.onResize)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.onResize)}},{key:"render",value:function(){return(0,this.props.children)({currentValue:this.state.currentValue})}}]),n}(s.PureComponent);(0,l.Z)(p,"defaultProps",{valueAtSmall:!1,valueAtMobile:!1,valueAtTablet:!1,valueAtDesktop:!1,valueAtWide:!1}),e.Z=p},15348:function(t,e,n){n.d(e,{Cd:function(){return v},K2:function(){return d},Wz:function(){return h},Z1:function(){return f},eO:function(){return g},ei:function(){return p},gP:function(){return m},oe:function(){return i}});var r=n(96649),o=n(78284),i=function(t){return(0,o.C5)()&&window.matchMedia?!!window.matchMedia("(min-width: ".concat(t,")")).matches:null},a=function(t){return(0,o.C5)()&&window.matchMedia?!!window.matchMedia("(max-width: ".concat(t,")")).matches:null},c=function(t,e){return(0,o.C5)()&&window.matchMedia?!!window.matchMedia("(max-width: ".concat(e,") and (min-width: ").concat(t,")")).matches:null},u=function(){return a(r.mq.mobile)},l=function(){return c(r.mq.mobile,r.mq.mobileLarge)},s=function(){return c(r.mq.mobileLarge,r.mq.tablet)},d=function(){return(0,o.C5)()&&window.matchMedia?!(u()||l()||s()):null},m=function(){return i(r.mq.tablet)},p=function(){return c(r.mq.tablet,r.mq.desktop)},f=function(){return c(r.mq.desktop,r.mq.wide)},h=function(){return i(r.mq.wide)},g=function(t){var e=t.valueAtSmall,n=t.valueAtMobile,o=t.valueAtMobileLarge,a=t.valueAtTablet,d=t.valueAtDesktop,m=t.valueAtDesktopLarge,p=t.valueAtWide,f=t.valueAtWideLarge,h=t.defaultValue||null;return i(r.mq.wideLarge)&&(f||p)&&(h=f||p),c(r.mq.wide,r.mq.wideLarge)&&p&&(h=p),c(r.mq.desktopLarge,r.mq.wide)&&(m||d)&&(h=m||d),c(r.mq.desktop,r.mq.desktopLarge)&&d&&(h=d),c(r.mq.tablet,r.mq.desktop)&&a&&(h=a),s()&&(o||n)&&(h=o||n),l()&&n&&(h=n),u()&&e&&(h=e),h},v=function(t){if((0,o.C5)()){var e=t.find((function(t){return a("".concat(t.toWidth,"px"))}));if(e)return e.value}return null}},34214:function(t,e,n){n.d(e,{NN:function(){return v},Vi:function(){return Z},WV:function(){return f},_b:function(){return p},b0:function(){return w},cE:function(){return h},fh:function(){return g},h1:function(){return d},rG:function(){return b},rX:function(){return m},tq:function(){return x}});var r=n(51705),o=n(65443),i=n.n(o),a=n(8131),c=n.n(a),u=n(35654),l=n(67958),s=(c().number,c().number,c().string,c().number,c().number,c().number,c().bool,c().string,c().string,c().shape({id:c().number,name:c().string,canonical_url:c().string,avatar_url:c().string}),c().bool,function(t){return t.length>0?"?film_ids[]=".concat(t.join("&film_ids[]=")):""}),d=function(t,e){return(0,l.ZP)(t).get("/ratings/".concat(e))},m=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o={};return null!==n&&(o.rating=n),null!==r&&(o.body=r),(0,l.ZP)(t).put("/ratings/".concat(e),{data:o})},p=function(t,e){return(0,l.ZP)(t).deleteRequest("/ratings/".concat(e))},f=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8;return(0,l.ZP)(t).get("/ratings/".concat(e,"/ranked?page=").concat(n,"&per_page=").concat(r))},h=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=s(e);return(0,l.ZP)(t).get("/user/ratings".concat(n))},g=function(t){var e=t.httpContext,n=t.userId,r=t.currentCursor,o=t.perPage;return(0,l.ZP)(e).get("/users/".concat(n,"/ratings?").concat((0,u.u3)(r,o)))},v=function(t,e){return(0,l.ZP)(t).get("/ratings/".concat(e,"/comments"))},b=function(t,e,n){return new Promise((function(o,a){if("undefined"!==typeof grecaptcha)try{grecaptcha.enterprise.ready((0,r.Z)(i().mark((function r(){var a,c;return i().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,grecaptcha.enterprise.execute("6Leny7AUAAAAABnijVtQaHmmFIgfhCGwUWV2FEWN",{action:"comment"});case 2:return a=r.sent,r.next=5,(0,l.ZP)(t).post("/ratings/".concat(e,"/comments"),{data:{body:n,recaptcha_token:a,recaptcha_action:"comment"}});case 5:c=r.sent,o(c);case 7:case"end":return r.stop()}}),r)}))))}catch(c){a(c)}else a(new Error("grecaptcha not initialised"))}))},Z=function(t,e){return(0,l.ZP)(t).post("/ratings/".concat(e,"/flagging"))},w=function(t,e){return(0,l.ZP)(t).deleteRequest("/ratings/".concat(e,"/flagging"))},x=function(t,e){return(0,l.ZP)(t).get("/ratings/".concat(e,"/flagging"))}},30621:function(t,e,n){n.d(e,{Cw:function(){return f},DD:function(){return s},DP:function(){return m},Rq:function(){return d},ST:function(){return l},z7:function(){return p}});var r=n(8131),o=n.n(r),i=n(67958),a=n(35654),c=n(35232),u=n(4790),l=(o().number,o().string,o().string,o().string,o().string,o().number,o().string,o().number,o().string,o().string,o().string,o().string,o().shape({summary:o().string,title:o().string}),o().string,o().string,o().shape(c.f6),o().arrayOf(o().shape(u.OM)),function(t,e,n){var r="/notebook/posts",o=(0,a.wK)(e,n);return o&&(r="".concat(r,"?").concat(o)),(0,i.ZP)(t).get(r)}),s=function(t,e){return(0,i.ZP)(t).get("/notebook/posts/".concat(e))},d=function(t,e){return(0,i.ZP)(t).get("/notebook/posts/".concat(e,"/comments"))},m=function(t,e){return(0,i.ZP)(t).get("/notebook/posts/".concat(e,"/related_films"))},p=function(t){return(0,i.ZP)(t).get("/notebook/posts/featured")},f=function(t,e){return(0,i.ZP)(t).get("/notebook/posts/".concat(e,"/latest"))}}}]);
//# sourceMappingURL=73094-0f90e5c15a128f71.js.map